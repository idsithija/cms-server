import{j as r,r as m,R as y}from"./react-eFnZCgGh.js";import{c as S}from"./react-dom-kVnsOIvz.js";import{B as b}from"./react-router-dom-vAq4ukfj.js";import{I as w,P as v,C as P,B as h,T,a as C}from"./primereact-I9Fpl7pS.js";import{c as N,f as q,a as E,i as I,b as O}from"./@reduxjs-hApJlUqT.js";import{E as R,F as L,a as U}from"./formik-1fh61bJv.js";import{c as A,a as p}from"./yup-n14rvPKV.js";import{u as f,O as F,a as M,b as u}from"./react-router-qLT2w2Dc.js";import{c as $}from"./redux-7CUyKLHK.js";import{a as B,P as G}from"./react-redux-rxmrMzQo.js";import"./redux-logger-8cJia76q.js";import"./hoist-non-react-statics-Ed-Y5ofb.js";import"./react-is-cHOZVpRJ.js";import"./scheduler-iwWdm5Ml.js";import"./@remix-run-XGnKtW4w.js";import"./react-transition-group-I0fgIxqk.js";import"./@babel-cnV2lN5_.js";import"./dom-helpers-Xf6xszNR.js";import"./immer-2oJgyI5v.js";import"./reselect-vVLqgz1U.js";import"./redux-thunk-qyK_zz9Y.js";import"./deepmerge-gNZfItMb.js";import"./lodash-es-PBfD76Wj.js";import"./react-fast-compare-lJ1TcC5A.js";import"./property-expr-lXxjllgd.js";import"./tiny-case--jO18g7D.js";import"./toposort-ovhdwucZ.js";import"./use-sync-external-store-isN2lx3L.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const l={currentUser:"/auth/currentuser",signIn:"/auth/signin",signOut:"auth/signout"},Q="/api",_=(e,t)=>N({reducerPath:e,baseQuery:q({baseUrl:Q}),tagTypes:t,endpoints:()=>({})}),c=_("authApi",["CurrentUser"]).injectEndpoints({endpoints:e=>({getCurrentUser:e.query({query:()=>l.currentUser,providesTags:["CurrentUser"],keepUnusedDataFor:.01}),signIn:e.mutation({query:t=>({url:l.signIn,method:"POST",body:t})}),signOut:e.mutation({query:()=>({url:l.signOut,method:"POST"}),invalidatesTags:["CurrentUser"]})})}),{useGetCurrentUserQuery:k,useSignInMutation:V,useSignOutMutation:H}=c,g=e=>{const{name:t,inputicon:n,children:i,label:s,required:o,disable:a,visible:x}=e,j=`${a?"disabled":""} ${o?"required":""}`.trim();return!x&&r.jsxs("div",{children:[s&&r.jsx("label",{htmlFor:t,className:j,children:s}),r.jsxs("div",{className:"p-inputgroup flex-1",children:[r.jsx("span",{className:"p-inputgroup-addon",children:n}),i]}),o&&r.jsx(R,{className:"from-error",name:t,component:"span"})]})},K=e=>{const{inputicon:t,label:n,required:i,visible:s,...o}=e;return r.jsx(g,{name:o.name,inputicon:t,label:n,required:i,visible:s,disable:o.disabled,children:r.jsx(w,{...o})})},W=e=>{const{inputicon:t,label:n,required:i,visible:s,...o}=e;return r.jsx(g,{name:o.name,inputicon:t,label:n,required:i,visible:s,children:r.jsx(v,{...o})})},z={username:"",password:""},D=A().shape({username:p().min(2,"Too Short!").max(50,"Too Long!").required("Username is required."),password:p().min(8,"Password is too short - should be 8 chars minimum.").required("Password is required")}),J=()=>{const[e]=V(),t=f(),n=s=>{e(s).unwrap().then(()=>{t("/dashboard")})},i=()=>r.jsx(h,{type:"submit",label:"Sign in"});return r.jsx(r.Fragment,{children:r.jsx("div",{className:"h-screen",children:r.jsx("div",{className:"h-full flex align-items-center",children:r.jsx("div",{className:"w-20rem mx-auto",children:r.jsx(L,{initialValues:z,validationSchema:D,onSubmit:s=>n(s),children:s=>r.jsx(U,{children:r.jsx(P,{title:"Login",className:"w-full",footer:()=>i(),children:r.jsxs("div",{className:"flex flex-column gap-4",children:[r.jsx(K,{id:"username",name:"username",placeholder:"Username",inputicon:r.jsx("i",{className:"pi pi-user"}),onChange:s.handleChange,required:!0}),r.jsx(W,{id:"password",name:"password",placeholder:"Password",inputicon:r.jsx("i",{className:"pi pi-lock"}),onChange:s.handleChange,required:!0})]})})})})})})})})},X=()=>{const{data:e,isLoading:t}=k(),n=f();if(!t)return e!=null&&e.currentUser||n("/"),r.jsx(F,{})},Y=()=>{const[e]=H(),t=()=>{e()};return r.jsx(h,{onClick:t,children:"Signout"})},Z={errors:[],showToast:!1},d=E({name:"toasterState",initialState:Z,reducers:{showToast:e=>{e.showToast=!0},hideToast:e=>{e.showToast=!1},addError:(e,t)=>{e.errors=t.payload}}}),{showToast:ee,hideToast:Qe,addError:re}=d.actions,se=$({[c.reducerPath]:c.reducer,[d.name]:d.reducer}),te=()=>e=>t=>{var n;if(oe(t)){const i=t;if(I(i)){let o=(n=i.payload.data)==null?void 0:n.errors;o||(o=[{field:"unknown",message:"Error occurred"}]),e(re(o)),e(ee())}}return e(t)};function oe(e){return e&&typeof e.type=="string"}let ne=[c.middleware,te];const ie=O({reducer:se,middleware:e=>e().concat(ne)}),ae=B,ce=e=>e.toasterState,ue=()=>{const e=m.useRef(null),{showToast:t,errors:n}=ae(ce);return m.useEffect(()=>{t&&e.current&&n.length>0&&n.forEach(i=>{var s;(s=e.current)==null||s.show({severity:"error",summary:"Error",detail:i.message})})},[t,n,e]),r.jsx(T,{ref:e})},le=()=>r.jsxs(r.Fragment,{children:[r.jsx(ue,{}),r.jsx(b,{children:r.jsxs(M,{children:[r.jsx(u,{path:"/",element:r.jsx(J,{})}),r.jsx(u,{element:r.jsx(X,{}),children:r.jsx(u,{path:"/dashboard",element:r.jsx(Y,{})})})]})})]});S.createRoot(document.getElementById("root")).render(r.jsx(y.StrictMode,{children:r.jsx(G,{store:ie,children:r.jsx(C,{children:r.jsx(le,{})})})}));
